\BLOCK{ set base_docclass_options = documentclass_options|default('', true) }
\BLOCK{ set combined_docclass_options = base_docclass_options[1:-1] if base_docclass_options else '' }
\BLOCK{ if columns|default(1)|int > 1 }
\BLOCK{   set combined_docclass_options = combined_docclass_options ~ (',' if combined_docclass_options else '') ~ 'twocolumn' }
\BLOCK{ endif }
\BLOCK{ set effective_documentclass_options = '[' ~ combined_docclass_options ~ ']' if combined_docclass_options else '' }
\documentclass\VAR{effective_documentclass_options}{article}

\VAR{extra_packages}
\usepackage{xcolor}
\definecolor{texsmithLinkColor}{HTML}{0B3D91}
\usepackage{graphicx}
\usepackage[\VAR{language|default('english')}]{babel}
\usepackage[colorlinks=true, linkcolor=texsmithLinkColor, urlcolor=texsmithLinkColor, citecolor=texsmithLinkColor]{hyperref}

\BLOCK{ if preamble }
% Custom document preamble injected from front matter overrides.
\VAR{preamble|safe}

\BLOCK{ endif }

\BLOCK{ set has_title_metadata = title|default('')|trim }
\BLOCK{ set effective_date = date|default('')|trim }
\BLOCK{ if has_title_metadata }
\title{\VAR{title}\BLOCK{ if subtitle }\\\large \VAR{subtitle}\BLOCK{ endif }}
\BLOCK{ if author }\author{\VAR{author}}\BLOCK{ else }\author{}\BLOCK{ endif }
\BLOCK{ if effective_date }\date{\VAR{date}}\BLOCK{ else }\date{\today}\BLOCK{ endif }
\BLOCK{ endif }

\begin{document}

\BLOCK{ if has_title_metadata }
\maketitle
\BLOCK{ endif }
\BLOCK{ if not page_numbers }
\pagenumbering{gobble}
\thispagestyle{empty}
\pagestyle{empty}
\BLOCK{ endif }

\BLOCK{ if abstract }
\begin{abstract}
\VAR{abstract}
\end{abstract}
\BLOCK{ endif }
\BLOCK{ if toc }
\tableofcontents
\BLOCK{ endif }

\VAR{mainmatter}

\VAR{backmatter}
\VAR{fragment_backmatter}

\end{document}
