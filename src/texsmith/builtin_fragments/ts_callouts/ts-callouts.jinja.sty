\ProvidesPackage{ts-callouts}[2025/11/21 TeXSmith Callouts (generated)]

\RequirePackage{xcolor}
\RequirePackage{tcolorbox}
\tcbuselibrary{breakable,skins}
\RequirePackage{fontawesome5}
\RequirePackage{fontspec}
\RequirePackage{graphicx}

\newcommand{\texsmithCalloutStyleDefault}{\VAR{callout_style|default('fancy')}}
\providecommand{\texsmithCalloutStyle}{\texsmithCalloutStyleDefault}

\ifdefined\IfFontExistsTF
  \IfFontExistsTF{Noto Emoji}{
    \newfontfamily\texsmithCalloutIconFont{Noto Emoji}[Renderer=Harfbuzz]
  }{
    \newcommand{\texsmithCalloutIconFont}[1]{#1}
  }
\else
  \newcommand{\texsmithCalloutIconFont}[1]{#1}
\fi
\newcommand{\texsmithCalloutIcon}[1]{%
  \ifdefined\texsmithCalloutIconFont
    {\texsmithCalloutIconFont #1}%
  \else
    #1%
  \fi
}

\BLOCK{ set style = callout_style | default("fancy") }
\BLOCK{ set callouts = callouts_definitions | default({}) }

\BLOCK{ for name, cfg in callouts.items() }
\definecolor{callout\VAR{name|capitalize}Bg}{HTML}{\VAR{cfg.get("background_color", "F0F0F0")}}
\definecolor{callout\VAR{name|capitalize}Frame}{HTML}{\VAR{cfg.get("border_color", "808080")}}
\definecolor{callout\VAR{name|capitalize}Title}{HTML}{\VAR{cfg.get("title_color", cfg.get("border_color", "808080"))}}
\BLOCK{ endfor }

\BLOCK{ if style == "classic" }
% Classic (monochrome) style
\newcommand{\texsmithCalloutTitleFormat}[1]{~#1}
\NewDocumentEnvironment{callout}{O{} m}{\begin{tcolorbox}[enhanced,breakable,colframe=black,colback=white,title={#2},#1]}{\end{tcolorbox}}
\BLOCK{ else }
% Fancy style (colored, icons)
\tcbset{callout base/.style={
  breakable,
  enhanced,
  arc=0.7mm,
  boxrule=0.1mm,
  titlerule=0mm,
  left=3mm,
  lefttitle=0.8mm,
  leftupper=1.5mm,
  coltitle=black,
  fonttitle=\bfseries\sffamily,
  parbox=false,
}}
\BLOCK{ for name, cfg in callouts.items() }
\tcbset{
  callout \VAR{name}/.style={
    callout base,
    colback=callout\VAR{name|capitalize}Bg,
    colframe=callout\VAR{name|capitalize}Frame,
    colbacktitle=callout\VAR{name|capitalize}Frame!5!white,
    coltitle=callout\VAR{name|capitalize}Title,
    borderline west={1.5mm}{0mm}{callout\VAR{name|capitalize}Frame},
    title={\makebox[1.6em][c]{\raisebox{0.05em}{\scalebox{1.2}{\texsmithCalloutIcon{\VAR{cfg.get("icon", "â„¹")}}}}}},
  }
}
\BLOCK{ endfor }

\newcommand{\texsmithCalloutTitleFormat}[1]{~#1}
\NewDocumentEnvironment{callout}{O{} m}{\begin{tcolorbox}[callout \texsmithCalloutStyle,after title={\texsmithCalloutTitleFormat{#2}},#1]}{\end{tcolorbox}}
\BLOCK{ endif }
