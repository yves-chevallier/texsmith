\documentclass\BLOCK{ if class_options and class_options.strip() }[\VAR{class_options}]\BLOCK{ endif }{sn-jnl}

\usepackage{fontspec}
\defaultfontfeatures{Ligatures=TeX}
\setmainfont{Latin Modern Roman}
\setsansfont{Latin Modern Sans}
\setmonofont{DejaVu Sans Mono}

\usepackage{microtype}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{mathrsfs}
\usepackage{multirow}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{hyperref}
\usepackage{hyphenat}
\usepackage[many,minted]{tcolorbox}

\BLOCK{ if acronyms }
\usepackage[acronym]{glossaries}
\makeglossaries
\BLOCK{ endif }
\BLOCK{ if index_entries }\usepackage{imakeidx}\BLOCK{ endif }

\tcbuselibrary{skins, breakable, minted}
\setlength{\parindent}{1em}
\setlength{\parskip}{0.5em}

\setminted{fontsize=\footnotesize, breaklines, autogobble, tabsize=4}
\usemintedstyle{friendly}

\newtcblisting[auto counter,number within=section,
  list inside=mypyg]{code}[4][]{%
  breakable,
  listing only,
  enhanced,
  colback=white,
  pad at break*=1mm,
  toptitle=0.15em,
  bottomtitle=0.1em,
  boxrule=0mm,
  frame hidden,
  minted language=#2,
  top=1mm,
  bottom=1mm,
  minted options={%
      breaklines,
      tabsize=4,
      autogobble,
      fontsize=\footnotesize,
      highlightcolor=yellow!20,
      #4
    },
  title={#3},
  list entry={\protect\numberline{\thetcbcounter}#3},
  #1
}

\raggedbottom

\title\BLOCK{ if short_title and short_title.strip() }[\VAR{short_title}]\BLOCK{ endif }{\VAR{title}}
\BLOCK{ if subtitle }\subtitle{\VAR{subtitle}}\BLOCK{ endif }
\BLOCK{ if author_entries }
\BLOCK{ for author in author_entries }
\author\BLOCK{ if author.corresponding }*\BLOCK{ endif }\BLOCK{ if author.indices }[\VAR{','.join(author.indices)}]\BLOCK{ endif }{\VAR{author.name}}
\BLOCK{ if author.email }\email{\VAR{author.email}}\BLOCK{ endif }
\BLOCK{ if author.equal_note }\equalcont{\VAR{author.equal_note}}\BLOCK{ endif }
\BLOCK{ endfor }
\BLOCK{ elif author }\author{\VAR{author}}\BLOCK{ endif }
\BLOCK{ for affiliation in affiliation_entries }
\affil\BLOCK{ if affiliation.id }[\VAR{affiliation.id}]\BLOCK{ endif }{\VAR{affiliation.text}}
\BLOCK{ endfor }
\BLOCK{ if date }\date{\VAR{date}}\BLOCK{ endif }

\BLOCK{ if abstract }\abstract{\VAR{abstract}}\BLOCK{ endif }
\BLOCK{ if keywords }\keywords{\VAR{keywords}}\BLOCK{ endif }

\begin{document}

\BLOCK{ if index_entries }\makeindex\BLOCK{ endif }

\maketitle

\BLOCK{ if frontmatter }\VAR{frontmatter}\BLOCK{ endif }

\VAR{mainmatter}

\BLOCK{ if acronyms }\printglossary[type=\acronymtype, title=List of Acronyms]\BLOCK{ endif }

\BLOCK{ if backmatter }\VAR{backmatter}\BLOCK{ endif }

\BLOCK{ if bibliography }\bibliography{\VAR{bibliography}}\BLOCK{ endif }

\BLOCK{ if index_entries }\printindex\BLOCK{ endif }

\end{document}
